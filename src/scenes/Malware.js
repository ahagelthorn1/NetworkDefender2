import { HealthBar } from "./HealthBar.js";
export class Malware extends Phaser.GameObjects.Sprite {
    constructor(scene, x, y, texture, BuildSign) {
        super(scene, x, y, texture);
        scene.add.existing(this);
        scene.physics.add.existing(this);
        this.direction = "DOWN";
        this.step1Done = false;
        this.step2Done = false;
        this.step3Done = false;
        this.step4Done = false;
        this.step5Done = false;
        this.step6Done = false;
        this.step7Done = false;
        this.step8Done = false;
        this.step9Done = false;
        this.healthBar = new HealthBar(this.scene, this.x, this.y - 35, 'HealthBar');
        this.healthBar.setDepth(11);
        this.setDepth(10);
        this.health = 100;
        if (!this.anims.exists('down')) {
            this.anims.create({
                key: 'down',
                frames: this.anims.generateFrameNumbers('Malware', { start: 0, end: 2 }),
                frameRate: 10,
                repeat: -1
            });
        }
        if (!this.anims.exists('up')) {
            this.anims.create({
                key: 'up',
                frames: this.anims.generateFrameNumbers('Malware', { start: 3, end: 5 }),
                frameRate: 10,
                repeat: -1
            });
        }
        if (!this.anims.exists('right')) {
            this.anims.create({
                key: 'right',
                frames: this.anims.generateFrameNumbers('Malware', { start: 6, end: 8 }),
                frameRate: 10,
                repeat: -1
            });
        }
        if (!this.anims.exists('left')) {
            this.anims.create({
                key: 'left',
                frames: this.anims.generateFrameNumbers('Malware', { start: 9, end: 11 }),
                frameRate: 10,
                repeat: -1
            });
        }
    }
    changeHealth(number) {
        this.health -= number;
        if (this.health < 100 && this.health >= 90) {
            this.healthBar.play('ninety');
        } else if (this.health < 90 && this.health >= 80) {
            this.healthBar.play('eighty');
        } else if (this.health < 80 && this.health >= 70) {
            this.healthBar.play('seventy');
        } else if (this.health < 70 && this.health >= 60) {
            this.healthBar.play('sixty');
        } else if (this.health < 60 && this.health >= 50) {
            this.healthBar.play('fifty');
        } else if (this.health < 50 && this.health >= 40) {
            this.healthBar.play('forty');
        } else if (this.health < 40 && this.health >= 30) {
            this.healthBar.play('thirty');
        } else if (this.health < 30 && this.health >= 20) {
            this.healthBar.play('twenty');
        } else if (this.health < 20 && this.health >= 10) {
            this.healthBar.play('ten');
        } else if (this.health < 10) {
            this.healthBar.play('zero');
        }
    }
    changeDirection(direction) {
        if (direction == "UP" && this.direction != "UP") {
            this.anims.play('up');
            this.direction = "UP";
        } else if (direction == "LEFT" && this.direction != "LEFT") {
            this.anims.play('left');
            this.direction = "LEFT";
        } else if (direction == "RIGHT" && this.direction != "RIGHT") {
            this.anims.play('right');
            this.direction = "RIGHT";
        } else if (direction == "DOWN" && this.direction != "DOWN") {
            this.anims.play('down');
            this.direction = "DOWN";
        }
    }
    moveDirect (xy, amount) {
        if (xy == "x") {
            this.x += amount;
            this.healthBar.x += amount;
        } else {
            this.y += amount;
            this.healthBar.y += amount;
        }
    }
    eliminate() {
        this.healthBar.destroy();
        this.destroy();
    }
    step1(speed) {
        if (this.y > 620) {
            this.moveDirect("y",-1 * speed);
        } else {
            this.step1Done = true;
            this.changeDirection("RIGHT");
        }
    }
    step2(speed) {
        if (this.x < 390) {
            this.moveDirect("x", speed);
        } else {
            this.step2Done = true;
            this.changeDirection("UP");
        }
    }
    step3(speed) {
        if (this.y > 330) {
            this.moveDirect("y", -1 * speed);
        } else {
            this.step3Done = true;
            this.changeDirection("LEFT");
        }
    }
    step4(speed) {
        if (this.x > 80) {
            this.moveDirect("x", -1 * speed);
        } else {
            this.step4Done = true;
            this.changeDirection("DOWN");
        }
    }
    step5(speed) {
        if (this.y < 530) {
            this.moveDirect("y", speed);
        } else {
            this.step5Done = true;
            this.changeDirection("RIGHT");
        }
    }
    step6(speed) {
        if (this.x < 505) {
            this.moveDirect("x",speed);
        } else {
            this.step6Done = true;
            this.changeDirection("UP");
        }
    }
    step7(speed) {
        if (this.y > 310) {
            this.moveDirect("y", -1 * speed);
        } else {
            this.step7Done = true;
            this.changeDirection("RIGHT");
        }
    }
    step8(speed) {
        if (this.x < 680) {
            this.moveDirect("x", speed);
        } else {
            this.step8Done = true;
            this.changeDirection("UP");
        }
    }
    step9(speed) {
        if (this.y > 250) {
            this.moveDirect("y", -1 * speed);
        } else {
            this.step9Done = true;
            this.scene.malwares.splice(this.scene.malwares.indexOf(this), 1);
            this.eliminate();
        }
    }
}
